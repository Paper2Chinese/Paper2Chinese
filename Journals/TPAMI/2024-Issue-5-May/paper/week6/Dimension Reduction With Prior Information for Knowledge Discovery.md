# 题目：[Dimension Reduction With Prior Information for Knowledge Discovery ](https://ieeexplore.ieee.org/stamp/stamp.jsp?tp=&arnumber=10371783)  
## 具有先验信息的降维方法在知识发现中的应用
**作者：Anh Tuan Bui** 

****
# 摘要
本文讨论了在存在其他已知特征的情况下，将高维数据映射到低维空间的问题。这一问题在科学和工程中普遍存在，因为大多数应用中通常都有可控/可测量的特征。为了解决这一问题，本文提出了一类广泛的方法，称为条件多维尺度（MDS）。同时，还开发了一种优化条件MDS目标函数的算法，并证明了该算法在温和假设下的收敛性。通过亲属术语、面部表情、纺织面料、汽车品牌感知和气缸加工的例子，展示了条件MDS的应用。这些例子证明了条件MDS在提高降维空间估计质量和简化可视化及知识发现任务方面的优势。此项工作的计算机代码可在开源的cml R包中找到。

# 关键词
- 距离缩放
- ISOMAP
- 多维尺度
- Sammon映射
- SMACOF





## I. 引言

降维对于科学家发现高维数据中的隐藏特征是必要的。具体来说，降维方法将高维观测值有意义地映射到某个低维空间。理想情况下，降维后的维数应尽可能小，以接近数据的内在维数 $[1]$。为实现这一目标，主成分分析（PCA）和因子分析被广泛用于学习线性映射。对于非线性情况，核PCA $[2]$和流形学习 $[3]$是流行的选择。自编码器是另一种非线性降维方法，已在许多研究中成功应用（例如， $[4], [5]$）。

大多数降维方法要求输入数据为向量形式。然而，数据有时是以相异度/相似度形式存在的（例如，相似度评分或互相关）。在许多应用中，实践者可能还希望为其数据定义合适的成对相异度测量，例如社区生态数据的相异度指数 $[6]$，随机异质材料图像数据的相异度 $[7]$，非结构化点云数据之间的相异度 $[8]$，文本数据中常用的余弦相异度 $[9]$，以及统计分布的距离度量 $[10]$。本文开发了一种直接以成对相异度为输入的降维方法。

现有的基于相异度的降维方法（参见第II.A节的简要回顾）在降维过程中大多无法结合已知特征的现有知识。例如，第IV.E节讨论了一个气缸加工的例子，其中气缸是通过不同组合的车床参数加工的。事实上，大多数科学和工程应用中通常都存在这样可控和/或可测量的特征。这一局限性通常导致两个潜在问题。首先，未能利用所有可用信息通常会导致降维空间的估计质量较差。其次，已知特征可能会在可视化中掩盖其他特征（由于维度排列 $[11]$、维度顺序 $[12]$或可视化失真 $[13]$的影响）；这可能会妨碍可视化和知识发现任务。

鉴于此，本文提出了一种新的基于相异度的降维框架，称为条件MDS。此外，还开发了一种优化算法来解决条件MDS的学习问题。该算法在温和假设下被证明是收敛的。本文的主要贡献在于，提出的条件MDS方法论和理论赋予了MDS分析结合已知特征现有知识的能力。这带来了以下优势：
- 通过更充分地利用可用数据，提高降维空间的估计质量。
- 通过两种方式简化可视化和知识发现任务。首先，将已知特征从降维空间中边缘化，有助于避免上述掩盖问题。其次，以前分析中发现的特征可以作为后续分析中的已知特征。这一知识发现过程更为简单，因为实践者不必一次性识别所有未知（包括意料之外）的特征，而是可以一次专注于一个或几个特征。

本文的结构如下。第二节回顾了相关工作，第三节提出了所提方法。第四节通过五个例子展示了所提方法相对于现有基于相异度的降维方法的优势。第五节讨论了所提方法的若干问题。最后，第六节总结了本文。


## III. 条件多维尺度

本节介绍所提的条件MDS框架及其优化算法。设 $\{u_  i = [u_  {i1}, u_  {i2}, \ldots, u_  {ip}]^T \in \mathbb{R}^p: i = 1, 2, \ldots, N\}$ 和 $\{v_  i = [v_  {i1}, v_  {i2}, \ldots, v_  {iq}]^T \in \mathbb{R}^q: i = 1, 2, \ldots, N\}$ 分别表示 $N$ 个对象的 $p$ 个未知特征和 $q$ 个已知特征的值。注意， $u$ 和 $v$ 构成了所有控制观察数据变化的潜在特征。因为观察数据的内在维数至多为 $N - 1$，所以要求 $N > p + q$。为了使未知特征 $u$ 和已知特征 $v$ 在一个单一流形坐标系中兼容，需要一个仿射变换 $B^T v$，其中 $B \in \mathbb{R}^{q \times q}$。此外，设 $U^T = [u_  1, u_  2, \ldots, u_  N] \in \mathbb{R}^{p \times N}$ 和 $V^T = [v_  1, v_  2, \ldots, v_  N] \in \mathbb{R}^{q \times N}$。因此， $[U, VB] \in \mathbb{R}^{N \times (p+q)}$ 包含了 $N$ 个对象的所有流形特征值。

条件MDS的目标函数称为“条件应力”：

$$
\sigma(U,B) = \sum_ {i<j} w_ {ij} (\delta_ {ij} - d_ {ij} (U,B))^2,
$$

其中 $w_ {ij}$ 和 $\delta_ {ij}$ 如 $(1)$ 所定义，

$$
d_ {ij} (U,B) = \sqrt{ \lVert u_  i - u_  j \rVert^2 + \lVert B^T (v_  i - v_  j) \rVert^2 }
$$

是上述流形坐标系中第 $i$ 和 $j$ 个对象之间的欧氏距离，适用于所有 $i, j$。条件MDS通过在 $U$ 和 $B$ 上最小化条件应力，以减少每对 $\delta_ {ij}$ 和 $d_ {ij}(U,B)$ 之间的差异。在某种意义上，这在降维空间中保留了原始信息（以相异度的形式）（以欧氏距离的形式）。与度量MDS类似，可以通过为条件应力函数使用不同的加权和相异度变换方案，得出条件MDS框架的各种变体。

在优化语言中，条件MDS的学习任务是解决

$$
U^\star,B^\star = \arg\min_ {U\in\mathbb{R}^{N\times p},B\in\mathbb{R}^{q\times q}} \sigma (U,B) .
$$

解决度量MDS学习问题的SMACOF算法 $[18]$ 不考虑已知特征 $v$ 的存在。它试图同时学习所有已知和未知特征。它不适用于解决利用已知特征信息的条件MDS学习问题 $(4)$。因此，本文基于SMACOF $[18]$ 的主要化技术，开发了一种“条件SMACOF”算法来解决 $(4)$。简言之，这一主要化技术为目标函数构建一个易于最小化的主要化函数。在条件SMACOF中，条件应力的主要化函数在 $U$ 和 $B$ 中是二次的。通过最小化这一主要化函数，条件应力函数也得到最小化。定理1中的 $U$ 和 $B$ 的更新公式 $(7)$ 和 $(8)$ 实际上对应于这一主要化函数的一个驻点。在假设1下，这些更新产生了一个单调递减的条件应力值序列。定理1的证明基于主要化技术和引理1。

定理1：定义 $H = [h_ {ij}]_ {N_ {i,j=1}} \in \mathbb{R}^{N \times N}$，

$$
h_ {ij} = 
\begin{cases}
-w_ {ij} & \text{if } i \neq j \\
\sum_ {k=1,k \neq i}^{N} w_ {ik} & \text{if } i = j
\end{cases}
$$

并且设 $H^+$ 为 $H$ 的Moore-Penrose逆。此外，设 $C(U, B) = [c_ {ij}]_ {N_ {i,j=1}} \in \mathbb{R}^{N \times N}$，

$$
c_ {ij} = 
\begin{cases}
-w_ {ij} \delta_ {ij} / d_ {ij}(U,B) & \text{if } d_ {ij} (U,B) \neq 0 \\
0 & \text{if } d_ {ij} (U,B) = 0
\end{cases}
\text{ for } i \neq j,
$$

以及 $c_ {ii} = \sum_ {j=1,j \neq i}^{N} c_ {ij}$。

此外，设 $U^{[l]}$ 和 $B^{[l]}$ 分别表示第 $l$ 次迭代时的 $U$ 和 $B$ 的值。如果 $U^{[l]}$ 和 $B^{[l]}$ 通过以下公式更新：

$$
U^{[l]} = H^+ C(U^{[l-1]}, B^{[l-1]}) U^{[l-1]}
$$

$$
B^{[l]} = (V^T H V)^{-1} V^T C(U^{[l-1]}, B^{[l-1]}) V B^{[l-1]}
$$

那么在假设1下， $\sigma(U^{[l]},B^{[l]}) \leq \sigma(U^{[l-1]},B^{[l-1]})$，且当且仅当 $U^{[l]} = U^{[l-1]}$ 和 $B^{[l]} = B^{[l-1]}$ 时等号成立。

假设1：
a) 相异度是对称的，因此，权重 $w_ {ij}$ 也是对称的 $(i, j = 1, 2, \ldots, N)$。
b) 权重矩阵 $[w]_ {N_ {i,j=1}}$ 是不可约的，即它不包含组间权重总是为0的组。
c) $V$ 包含 $q$ 个线性无关的差向量 $v_ j - v_ k$ $(1 \leq j < k \leq N)$。

引理1：在假设1下， $V^T H V$ 是正定的。
在实践中，建议当条件应力的减少小于某个阈值时，停止迭代更新 $(7)$ 和 $(8)$。注意，条件应力取决于转换相异度 $\delta_ {ij}$ 的规模。为了提供一个尺度不变的度量，以便在不同情况下使用一个通用阈值，我们定义“归一化条件应力”：

$$
\sigma_n (U,B) = \frac{\sigma (U,B)}{\sum_{i<j} w_{ij} \delta_{ij}^2} = \frac{\sum_{i<j} w_{ij} (\delta_{ij} - d_{ij} (U,B))^2}{\sum_{i<j} w_{ij} \delta_{ij}^2},
$$

注意，归一化条件应力表示在降维空间中未能解释的加权平方和。

![在这里插入图片描述](https://img-blog.csdnimg.cn/direct/18e26a5163a349daba229e151122a2aa.png)


算法1总结了基于条件SMACOF的条件MDS算法的主要步骤。所需输入包括给定的 $N \times N$ 相异度矩阵 $\Delta = [\delta_ {ij}]_ {i,j = 1,..,N}$，已知特征值 $V$，权重 $w_ {ij}$，连续迭代间归一化条件应力减少的最小阈值 $\gamma$，以及最大迭代次数 $l_ {max}$。

算法1的步骤1初始化并预先计算步骤2中迭代所需的量。 $B$ 可以通过一个单位矩阵初始化， $U$ 可以随机初始化。在步骤2中， $U$ 和 $B$ 分别根据 $(7)$ 和 $(8)$ 迭代更新，直到迭代次数达到 $l_ {max}$ 或上一次迭代的归一化条件应力 $\sigma(U, B)$ 的减少不大于 $\gamma$。最后，步骤3返回最优 $U^\star, B^\star$ 和归一化条件应力。注意，实践者可能希望运行算法几次，以找到产生最小归一化条件应力的初始配置。算法1的收敛性由推论1保证。所有证明可以在本文的补充材料中找到。

推论1：在假设1下，如果 $U$ 和 $B$ 按照算法1中的 $(7)$ 和 $(8)$ 迭代更新（ $l_ {max} = \infty$ 和 $\gamma = 0$），则它们将收敛到条件应力函数的一个临界点。

备注1：假设1(b) 表明 $H$ 的秩为 $N - 1$。在这种情况下， $H$ 的Moore-Penrose逆可以通过以下公式计算： $H^+ = (H+ 1_ {N \times N})^{-1} - N^{-2} 1_ {N \times N}$，其中 $1_ {N \times N}$ 是一个所有元素为1的 $N \times N$ 矩阵 $[17]$。更重要的是，计算 $C(U^{[l-1]}, B^{[l-1]}) U^{[l-1]}$ 比先计算 $(7)$ 中的 $H^+ C(U^{[l-1]}, B^{[l-1]})$ 更具计算效率。

备注2：如果 $w_ {ij} = 1$ $(\forall i, j = 1, 2, \ldots, N)$，则从 $(5)$ 得到 $H = N I - 1_ {N \times N}$，其中 $I$ 是 $N \times N$ 的单位矩阵。可以验证 $H^+ = N^{-2} H = I_ N/N - 1_ {N \times N}/N^2$。这一公式避免了对 $(H+ 1_ {N \times N})$ 求逆，在大 $N$ 时更具计算效率。此外，对于大 $N$，求和项 $1_ {N \times N}/N^2$ 是可以忽略的，我们也可以通过 $H^+ \approx N^{-1} I$ 进行近似。这一近似有助于避免矩阵求逆和矩阵乘法（通过在 $(7)$ 中用 $N^{-1}$ 替换 $H^+$）。

备注3：如果我们知道已知特征分别对成对距离的贡献，可以对 $B$ 施加对角结构。设 $b_  m$ 为对角矩阵 $B$ 的第 $m$ 个对角元素， $b_  m^{[l]}$ 为第 $l$ 次迭代时的值。基于 $(8)$， $b_  m^{[l]}$ $(m = 1, 2, \ldots, q)$ 可以通过以下公式更新：

$$
b_  m^{[l]} = \left[ V^T C(U^{[l-1]}, B^{[l-1]}) V \right]_ {mm} \left[ V^T H V \right]_ {mm} b_  m^{[l-1]},
$$

其中 $[\cdot]_ {mm}$ 表示方括号内矩阵的第 $m$ 个对角元素。

备注4：即使已知特征与未知特征之间存在函数关系（例如 $v = g(u)$），监督/充分降维方法也不适用于本文中的问题。将 $v$ 视为结果来使用监督/充分降维将导致（隐含地）学习函数 $g(\cdot)$，这与映射 $u$ 和 $v$ 到数据空间中的流形的底层函数不同，例如 $f(u, v) = f(u, g(u))$。

![在这里插入图片描述](https://img-blog.csdnimg.cn/direct/a222b851e9d649009d4e678f0f1a1eaf.png)



备注5：注意在 $(3)$ 中， $B$ 解释了已知特征 $v$ 对成对距离的联合影响，与未知特征 $u$ 一致。因此，通过学习 $B$，我们可以将已知特征对成对距离的联合影响与未知特征的影响分离。这就是条件MDS如何在降维结果中边缘化已知特征的方法。



## IV. 示例

本节通过若干示例展示了条件MDS的优势。具体来说，第IV.A节通过亲属术语示例说明了条件MDS如何简化可视化和知识发现任务。为了展示结合已知特征现有知识以提高降维空间估计准确性的好处，第IV.B、IV.C、IV.D和IV.E节分别在面部表情、纺织面料、模拟汽车品牌感知和气缸加工四个示例中将条件MDS与四种基于相异度的降维方法（度量MDS、ISOMAP、t-SNE和UMAP）进行比较。如引言中所述，我们假设输入数据为成对相异度。因此，不考虑不能以成对相异度作为输入的降维方法（如PCA及其变体）。

### A. 亲属术语

本节通过亲属术语示例展示了条件MDS在简化可视化和知识发现任务方面的优势。如第I节所述，已知特征可能在可视化中掩盖未知特征。为了说明这一问题，图1(a)展示了通过度量多维尺度（MDS）应用于Rosenberg和Kim研究中的14个亲属术语的成对相异度找到的二维（2D）坐标。经过一定的旋转，可以推断出一个特征是性别（见Borg等人 $[42]$ 的MDS结果解释的全面处理）。然而，图1(a)中另一个特征的解释并不明显，因为性别可能掩盖了这一特征。

条件MDS通过将已知特征从降维结果中边缘化，以暴露未知特征来解决这一问题。为此，图1(b)展示了与图1(a)类似的图，但为使用性别作为亲属术语已知特征的条件MDS降维结果。有趣的是，我们可以在图1(b)中看到七对高度相似的亲属术语：姐姐/哥哥（即兄弟姐妹）、母亲/父亲（即父母）、女儿/儿子（即子女）、祖母/祖父（即祖父母）、孙女/孙子（即孙子女）、侄女/侄子（即侄子侄女）、姑姑/叔叔（即叔婶）。随着性别从降维空间中边缘化，图1(b)沿虚线箭头揭示了亲属度等级的变化。在此示例中，条件MDS有助于识别新的“亲属度”特征。

此外，条件MDS允许实践者在后续分析中重复将先前分析中发现的特征添加到已知特征集中。例如，图1(c)展示了与图1(b)类似的图，但为使用性别和亲属度作为已知特征的条件MDS降维结果。随着性别和亲属度从降维空间中边缘化，图1(c)沿虚线曲线箭头揭示了世代转变（祖父母 → 父母/叔婶 → 兄弟姐妹 → 子女/侄子侄女 → 孙子女）。因此，条件MDS有助于另外识别新的“世代”特征。

备注6：条件MDS不仅限于与图1中的2D散点图一起使用。还可以结合其他高维可视化技术（例如，RadViz图 $[43]$ 或星座图 $[44]$）一起使用条件MDS，以一次发现多个特征。为了说明这一点，本文补充材料中的图S1展示了为14个亲属术语学习的三个度量MDS坐标的RadViz图。该图揭示了性别和亲属度特征，但没有揭示世代。然而，使用性别和亲属度作为已知特征的进一步条件MDS分析可以暴露图1(c)中的世代。为了方便一般读者和实践者理解，本文使用2D散点图。

![在这里插入图片描述](https://img-blog.csdnimg.cn/direct/c2657b81d73744d1a34f1d5b782c941a.png)


### B. 面部表情

本节测试了Abelson和Sermat $[45]$ 研究中的面部表情数据。在这项工作中，作者获得了13种面部表情的成对相异度（通过要求30名女性对13张照片的每对给出9点相异度评分）。他们展示了Engen等人 $[46]$ 对这13种面部表情的三个Schlosberg量表（愉快-不愉快（PU）、注意-拒绝（AR）和紧张-睡眠（TS））的估计值解释了75%的相异度变化。注意，从Engen等人 $[46]$ 的数据计算出的PU-AR、PU-TS和AR-TS之间的绝对相关性分别为0.18、0.15和0.75。为了验证条件MDS的性能，使用这三个Schlosberg量表中的一个或两个作为已知特征。我们将其他量表视为未知特征以进行评估。本示例共考虑了六种已知特征集的不同情况。

基于平均典型相关性（ACC）比较了条件MDS和度量MDS，如下所述。对于条件MDS，我们首先将已知特征与学习特征结合，每种情况下共有三个特征。然后，我们计算它们与未知特征的ACC。这样计算的理由是，条件MDS的降维空间可以看作由 $p$ 个学习特征和 $q$ 个已知特征组成。对于度量MDS，我们计算三个度量MDS维度与所有三个Schlosberg量表之间的ACC，因为度量MDS将所有这些量表视为未知特征。表I报告了度量MDS（第1列）和六种不同已知特征集情况下的条件MDS（第2-7列）的ACC。从表I可以看出，条件MDS在所有情况下显著提高了降维空间的估计准确性。

为了获得更多关于条件MDS的见解，表II报告了六种不同已知特征集情况下，第一个条件MDS维度与PU、AR或TS之间的绝对相关性。所有情况下的结果一致表明，第一个条件MDS维度与已知特征的相关性较弱，大多数时候与未知特征的相关性较强。这表明条件MDS有效地边缘化了已知特征，正确地学习了未知特征。注意，当使用PU作为单一已知特征时，除了第一个条件MDS维度与TS之间的强相关性（0.91）外，该维度还显示出与AR的较高相关性（0.72）。这表明该维度与TS和AR有关，这是由于它们之间的内在相关性。使用 $\{PU, AR\}$ 或 $\{PU, TS\}$ 作为已知特征集时，第一个条件MDS维度与未知特征的中等相关性也可能是由于AR和TS之间的内在强相关性。

![在这里插入图片描述](https://img-blog.csdnimg.cn/direct/671440b060284ea5bf3d5b80e982ccc4.png)



### C. 纺织面料

本节测试了来自textile2数据集 $[47]$ 的纺织面料图像。该数据集包含在两个面料样品的非重叠区域拍摄的图像。这两个面料样品的纹理略有不同。我们随机选择每个样品的15张图像。为了评估目的，我们随机对这30张图像应用以下三种变化。第一种是图像的90度旋转。其他两种是图像在水平方向和垂直方向上的数字收缩，最多可达50%。我们使用伯努利分布来确定图像是否旋转。我们使用均匀分布来确定收缩量。然后，将结果图像裁剪为 $250 \times 250$ 像素。因此，四个潜在特征控制了图像之间的差异：纹理、旋转和垂直/水平收缩。

我们通过两种不同的度量计算这30张图像的成对相异度。第一种是Bui和Apley $[7]$ 对具有随机纹理的表面图像的Kullback-Leibler（KL）相异度度量。第二种是将每张图像的像素强度集合视为 $250 \times 250 = 62500$ 维向量时的欧氏距离（ED）。我们将条件MDS应用于这些相异度，使用纹理和旋转作为已知特征。我们设置未知特征数 $p = 2$，这是通过第V.V节中讨论的碎石图法找到的（见本文补充材料中的图S2）。我们以与第IV.B节相同的方式将条件MDS与度量MDS进行比较，另外还包括ISOMAP、t-SNE和UMAP。

对于条件MDS，我们计算了四个潜在特征与条件MDS学习的两个已知特征和两个学习特征组合的ACC。对于度量MDS、ISOMAP、t-SNE和UMAP，我们计算了四个潜在特征与这些方法学习的四个特征之间的ACC。表III显示了所有方法在KL相异度和ED下的ACC。从表III可以看出，当使用KL相异度度量时，条件MDS几乎产生了其学习的四维空间与四个潜在特征之间的完美典型相关性。所有其他降维方法的表现都要差得多，因为它们没有利用已知特征的可用信息。此外，当使用ED计算相异度时，所有方法的表现都很差。这是由于纺织面料纹理的随机性，ED无法完全捕捉。这突出了基于相异度的降维的必要性，以便可以使用合适的相异度度量。

为了展示更多关于条件MDS的见解，表IV报告了条件MDS从KL相异度中学习的两个维度与四个潜在特征之间的相关性。再次，学习的维度与至少一个未知特征（水平/垂直收缩）强相关，与已知特征（纹理和旋转）弱相关。

![在这里插入图片描述](https://img-blog.csdnimg.cn/direct/13f90fe852314e92adf293273815e237.png)



### D. 汽车品牌感知

本节评估了条件MDS在一个模拟的汽车品牌感知示例中的应用。假设表V中的七个特征对汽车品牌之间的相异度有贡献。使用Uniform(0, 1)分布生成这些特征的值，生成 $N = 30$ 个汽车品牌。然后，计算汽车品牌之间的成对相异度，作为特征向量的加权欧氏距离（使用表V中的权重除以它们的总和），加上均值为0、标准差等于加权欧氏距离20%的正态噪声。特征和权重取自Consumer Reports的2014年汽车品牌感知调查 $[48]$。

在表V中的七个特征中，我们考虑了三种已知特征集的情况：情况#1 - $\{质量、安全、价值、性能\}$，情况#2 - $\{质量、安全、价值、性能、环保\}$，情况#3 - $\{质量、安全、价值、性能、环保、设计\}$。我们还假设已经努力估计了已知特征在 $N$ 个汽车品牌中的感知值。为了模拟估计值，我们在生成的已知特征值中加入噪声。这些噪声服从均值为0、标准差等于相应已知特征生成值5%的正态分布。

与第IV.C节中的示例类似，条件MDS与度量MDS、ISOMAP、t-SNE和UMAP在ACC方面进行了比较。然而，这里的ACC是计算所有方法（包括条件MDS）的降维空间与表V中所有七个特征的真实值之间的ACC（即在加入噪声之前）。表VI报告了100次蒙特卡罗重复实验中所有方法的ACC的中位数（括号内为四分位数范围）。表VI显示，条件MDS提高了降维空间的学习准确性。利用的已知特征越多，学习准确性越高。

![](https://img-blog.csdnimg.cn/direct/526adf377e6248c9ac807d341c254dad.png)


为了提供更多关于条件MDS的见解，表VII报告了100次蒙特卡罗重复实验中，第一个条件MDS维度与每个特征的绝对相关性中位数（括号内为四分位数范围）。表VII与前面的示例表明了类似的观察结果。特别是，对于已知特征的绝对相关性中位数较弱，对于至少一个未知特征的绝对相关性中位数较强。表VII中第一个条件MDS维度与已知特征的绝对相关性中位数较弱，清楚地表明条件MDS有效地边缘化了已知特征的影响。

表VII的结果还展示了条件MDS在简化可视化和知识发现任务中的优势。假设实践者从情况#1中的四个已知特征开始，通过可视化学习的条件MDS维度发现环保特征。然后，实践者可以重复这一过程，使用这四个已知特征 + 环保（即情况#2）发现设计特征。再重复一次这个过程，使用四个原始已知特征 + 环保 + 设计（即情况#3），实践者可以发现技术特征。这一过程在本文补充材料中的图S3中得以展示。注意，如果没有条件MDS，实践者将需要同时发现环保、设计和技术，并重新发现其他四个已知特征；这是一个更具挑战性的任务。

由于表V中的特征分别对成对相异度有贡献，因此此示例中每种情况的 $B$ 的真值是一个对角矩阵。该矩阵的对角值是相应已知特征的权重。然而，我们假设这是未知的，并在此示例中使用了更新公式 $(8)$ 而非 $(10)$ 来计算 $B$。为了证明条件MDS仍能很好地学习 $B$，图2展示了100次蒙特卡罗重复实验中，三种已知特征情况的每个元素的估计误差均值（MSE） $\times 10^{-5}$。从图2可以看出，条件MDS在所有情况下都准确估计了 $B$。

![](https://img-blog.csdnimg.cn/direct/b70c38e2219a4509a343ee6498265e2a.png)


### E. 气缸加工

该示例涉及90个气缸的表面测量 $[49]$。具体来说，测量了每个气缸表面的 $210 \times 64$ 网格上的径向偏差。因此，每个气缸对应一个 $13330$ 维向量。在测量之前，使用两种车床加工参数的九种不同组合对气缸进行了加工。第一个参数是车削速度，取值为 $\{80, 70, 65\}$ 米/分钟。第二个参数是切削深度，取值为 $\{0.4, .08, 1.2\}$ 毫米。每个组合有10个气缸。

假设气缸之间的欧氏距离给定为它们的成对相异度。条件MDS应用于这些相异度，使用两个车床加工参数作为已知特征。目标是识别在此气缸加工过程中导致表面变化的潜在未知特征。同样使用第V.B节中的碎石图法，选择 $p= 3$ 作为未知特征的数量（见本文补充材料中的图S4）。

![](https://img-blog.csdnimg.cn/direct/45e09b2bb7a44e7e813fa81e45414fd0.png)


表VIII显示了车床加工参数与三个条件MDS维度之间的绝对相关性。如果车床加工参数完全边缘化，我们可以预期这些相关性接近0。然而，有些相关性是中等的。这表明气缸可能没有在设置值下准确加工。因此，条件MDS可以帮助过程控制器意识到可能存在导致车床加工参数变化的未知因素（例如，电压波动或工具磨损）。

回想一下，最优的 $p$ 值确定为 $3$。因此，除了与两个车床加工参数变化相关的两个潜在未知特征外，还有另一个潜在未知特征。为调查这一点，图3绘制了 $u_ {\cdot,2}$ 与 $u_ {\cdot,1}$ 的关系，并在相应的 $u_ {\cdot,1}$ 和 $u_ {\cdot,2}$ 值处叠加了一些气缸的顶部视图。注意，这些顶部视图被放大，以显示气缸标准径向偏差的小变化。一般来说，气缸的顶部截面比底部截面更宽（可能是因为气缸在加工时固定在底部）。

从图3可以看出，气缸的顶部截面是椭圆形的。此外，它们的取向角度从左下角到右上角的变化幅度趋于增加。为了更清楚地看到这一变化，在顶部视图中间显示了估计的取向角度。每个估计值是每个气缸10个顶部截面的旋转角度的中位数。这些角度估计的绝对值与我们上述观察一致。因此，条件MDS可以帮助过程控制器识别第三个未知特征，即气缸绕其轴线的旋转。

## V. 讨论

### A. 假设的有效性

本节讨论假设1中假设的有效性，这是条件SMACOF收敛所必需的。首先，假设1(a) 几乎总是成立的，因为即使相异度 $\delta_ {ij}$ $(i, j = 1, 2, \ldots, N)$ 不是对称的（在实践中很少见），我们可以通过用 $\delta_ {ij} + \delta_ {ji}$ 替换 $\delta_ {ij}$ 和 $\delta_ {ji}$ $(i, j = 1, 2, \ldots, N)$ 使其对称。对于对称的相异度，没有理由使用 $w_ {ij} \neq w_ {ji}$ $(i, j = 1, 2, \ldots, N)$。其次，假设1(b) 对条件SMACOF来说没有通用性的损失。如果这一假设被违反，我们可以将条件SMACOF应用于每个组。根据定义，每个组的权重矩阵是不可约的 $[18]$，满足假设1(b)。第三，如果 $V$ 包含少于 $q$ 个线性独立的差向量 $v_ j - v_ k$ $(1 \leq j < k \leq N)$，则假设1(c) 被违反。这种情况在实践中很少见，因为差向量的数量随着 $N$ 的平方增长。减少 $q$ 是解决这一情况的一个选项。如果发生这种情况，我们可以略微扰动 $V$，使其包含 $q$ 个线性独立的差向量。



### B. p 的选择

一个自然的问题是如何选择最小数量的未知特征 $p$，而不会丢失数据中的信息。答案类似于传统降维方法的情况，常见的解决方案基于降维结果的某种拟合度量的碎石图。例如，经典MDS中通常使用特征值，度量MDS中通常使用应力。对于条件MDS，我们可以在条件应力对 $p$ 的碎石图的拐点处选择 $p$。

图4展示了第IV.D节中的汽车品牌感知示例，使用七种不同的已知特征集的碎石图： $\{质量\}$ $(q = 1)$， $\{质量、安全\}$ $(q = 2)$， $\{质量、安全、价值\}$ $(q = 3)$， $\{质量、安全、价值、性能\}$ $(q = 4)$， $\{质量、安全、价值、性能、环保\}$ $(q = 5)$， $\{质量、安全、价值、性能、环保、设计\}$ $(q = 6)$，和 $\{质量、安全、价值、性能、环保、设计、技术\}$ $(q = 7)$。注意， $p = 0$ 的情况的解决方案可以通过修改条件SMACOF仅更新 $B$ 并将与 $u$ 相关的值设为0来获得。图4显示，每个碎石图的拐点出现在 $p$ 的真实值处，即 $7 - q$。当 $p$ 真正为0时（即 $q = 7$ 的情况），碎石图没有明显的拐点。这就是我们如何确定数据中是否存在未知特征的方法。


### C. 无关已知特征

本节讨论了当已知特征集中包含无关特征时，条件MDS的稳健性。我们使用第IV.D节中的汽车品牌感知模拟示例进行说明。为了简洁，本节仅考虑情况#1。这意味着质量、安全、价值和性能是相关的已知特征。为了创建无关已知特征，我们以表V中的特征相同的方式生成了一些特征，但在计算汽车品牌之间的相异度时不使用它们。我们在本示例中使用 $N = 100$。我们将条件MDS应用于该数据集，使用质量、安全、价值、性能和无关特征作为已知特征。为了完全关注 $B$ 对角元素 $b_  m$ 的估计质量，这里使用严格对角 $B$ 的条件SMACOF版本。

![](https://img-blog.csdnimg.cn/direct/cc6b145dc07b4a9b8ccf7bb1f1a7212d.png)


设 $\hat{b}_  m$ 为 $b_  m$ 的估计值， $s_  m$ 为 $V$ 的第 $m$ 列的样本标准差 $(m=1, 2, \ldots, q)$。设 $\mathcal{S}$ 为相关特征的索引集， $|\mathcal{S}|$ 为其基数。我们根据以下两种度量评估本示例中的条件MDS结果。第一种度量是相关特征对应的 $b_  m$ 估计的MSE：

$$
\sum_ {m \in \mathcal{S}} \frac{(\hat{b}_  m - b_  m)^2}{|\mathcal{S}|}.
$$

这一度量告诉我们条件MDS在多大程度上准确地学习了相关已知特征的影响。第二种度量是

$$
r = \frac{\sum_ {m \in \mathcal{S}} |\hat{b}_  m| s_  m / |\mathcal{S}|}{\sum_ {m \in \{1, \ldots, q\} \setminus \mathcal{S}} |\hat{b}_  m| s_  m / (q - |\mathcal{S}|)},
$$

可以视为“信噪比”。这一度量是相关特征的 $b_  m$ 估计的平均值与无关特征的 $b_  m$ 估计的平均值之比。 $r$ 越大，条件MDS的准确性越高。注意， $s_  m$ 出现在这一度量中，是为了考虑特征尺度的差异。

图5绘制了这两种度量与无关特征数量的关系。我们可以看到，随着无关特征数量增加到30左右，MSE度量略有增加，但似乎随后趋于稳定。更重要的是，即使无关特征数量接近汽车品牌数量 $N = 100$，MSE也非常小。这表明条件MDS能够很好地学习相关已知特征的影响。我们还可以看到，随着无关特征数量的增加，“信噪比” $r$ 持续增加。由于相关特征的 $\hat{b}_  m$ 估计值接近真实值（由于MSE较小），无关特征的 $\hat{b}_  m$ 估计值接近0。

![](https://img-blog.csdnimg.cn/direct/e46532610ee049d0b4e57ae7899e7d3f.png)

### D. 用 B 解释

本节讨论了 $B$ 的两种解释（见本文补充材料中的S2节的示例）。第一种涉及 $B$ 的列，我们假设已知特征是标准化的。回想一下，已知特征与 $B$ 的每列线性组合，创建仿射变换特征。因此，我们可以使用 $B$ 每列的值来确定已知特征在 $(3)$ 中对成对距离的贡献。第二种涉及 $B$ 的行，我们不要求已知特征标准化，但我们假设 $i$ 和 $j$ 对象之间的相异度 $\delta_ {ij}$ 等于 $d_ {ij}(U,B)$ 加上一些噪声。从 $(3)$ 中可以看出，已知特征第 $m$ 项在 $i$ 和 $j$ 对象之间的差异增加一个单位，将使平方相异度 $\delta_ {ij}^2$ 增加 $B$ 第 $m$ 行元素平方和。因此，已知特征对对象之间相异度的重要性体现在其对应行中元素的大小上。在 $B$ 严格对角的特殊情况下，第 $m$ 行的平方和简化为 $b_  m^2$。我们在第V.C节的示例中遇到这种情况，其中相关已知特征的 $\hat{b}_  m^2$ 很大，而无关特征的 $\hat{b}_  m^2$ 接近0。


### E. 归一化条件应力

本节说明了本文使用的示例中归一化条件应力的行为。特别是，图6绘制了每个示例中条件MDS的前100次迭代的归一化条件应力（以对数刻度表示）。显然，在所有示例中，归一化条件应力在前几次迭代（尤其是第一次）显著减少。然后，按预期逐渐减少（见定理1）。总体而言，归一化条件应力相对较快地达到较小值。这些观察结果表明，至少在这些示例中，条件SMACOF可以较早停止迭代。事实上，这种早期停止策略也广泛用于传统的SMACOF算法。

### F. 计算复杂度

本节讨论了条件SMACOF的计算复杂度。条件SMACOF的空间复杂度为 $O(N^2)$，适用于处理相异度矩阵的任何算法。接下来，我们讨论条件SMACOF的时间复杂度，并将其与SMACOF、ISOMAP、t-SNE和UMAP进行比较。

本文补充材料中的表S1提供了条件SMACOF主要计算的时间复杂度。如果我们假设 $N \gg p + q$，则从该表可以导出条件SMACOF的时间复杂度为： $(i)$ 当 $w_ {ij}$ 为1时为 $O(N^2)$， $(ii)$ 否则为 $O(N^{2.373})$。注意，这些时间复杂度与传统SMACOF算法相同。ISOMAP和t-SNE的时间复杂度均为 $O(N^2)$ $[19], [20]$，这与所有权重 $w_ {ij}$ 为1时的条件SMACOF相同。UMAP的时间复杂度在很大程度上取决于其最近邻搜索步骤 $[21]$，如果近似完成，通常具有比 $O(N^2)$ 好得多的经验性能。

我们现在比较条件SMACOF（针对 $w_ {ij}$ 的两种加权方案）的计算时间与SMACOF、ISOMAP、t-SNE和UMAP的计算时间。这里我们重用第IV.D节中的汽车品牌感知示例，但改变 $N$ 以研究其对计算时间的影响。我们使用 $\{质量、安全、价值、性能\}$ 作为条件MDS的已知特征集。除了ISOMAP有解析解外，其他方法都依赖于迭代优化。因此，我们将所有这些迭代方法的迭代次数设置为100，以更清晰地显示它们的执行时间。图7绘制了所有方法的计算时间。显然，t-SNE是最慢的方法，尤其是对于较大的 $N$。SMACOF、ISOMAP和条件SMACOF的执行时间在测试的 $N$ 值范围内相似。然而，ISOMAP的执行时间随着 $N$ 的增加迅速增加。

UMAP似乎是最快的方法。然而，其ACC性能远逊于条件MDS，且随着 $N$ 的增加显著下降（见图8）。因此，对于较大的 $N$，UMAP需要花费更多时间执行足够多的迭代以获得良好的降维结果。对于图7中 $N = 2000$ 的示例，UMAP需要大约100和200秒执行5000和10000次迭代，分别得到0.56和0.60的ACC。然而，这些ACC仍远逊于此示例中的条件SMACOF。后者在所有测试的 $N$ 值范围内使用仅100次迭代保持接近最大ACC。

![](https://img-blog.csdnimg.cn/direct/e0f1e3b236384e548495c5d21c820848.png)


## VI. 结论

在存在其他已知特征的情况下，将高维数据映射到低维空间的问题在科学和工程中普遍存在。这是因为大多数应用中通常都有可控/可测量的特征。为了解决这一问题，本文提出了一类广泛的条件MDS方法。开发了一种条件SMACOF算法，以优化条件MDS的条件应力目标函数。证明了该算法在温和假设下的收敛性。通过多个示例表明，所提出的条件MDS方法在降维空间的估计准确性和简化可视化及知识发现任务方面优于传统的基于相异度的降维方法（例如，度量MDS、ISOMAP、t-SNE和UMAP）。所提出的条件MDS框架还为降维领域带来了若干理论见解。

然而，仍有一些问题和未来工作的潜在方向。首先，本文处理的已知特征是连续的。需要进一步研究将条件MDS扩展到其他类型的已知特征（例如，分类或有序特征）。其次，本文假设已知特征具有固定值。Gilbert和Müller $[50]$ 的工作研究了如何结合随机已知特征。第三，我们可以研究其他方法以减少条件SMACOF的计算复杂度。例如，可以轻松采用SMACOF $[51]$ 的稀疏变体。第四，开发结合其他“专门”设置的“广义”条件MDS框架将是有趣的。这可以为基于相异度的降维提供一个整体统一的框架。

最后，提供了一个开源的R包cml，其中包括所提出的条件MDS方法和条件SMACOF算法的实现。我们希望该包提供的工具能够成为降维领域研究人员和实践者的有用资源。
# 声明
本文内容为论文学习收获分享，受限于知识能力，本文队员问的理解可能存在偏差，最终内容以原论文为准。本文信息旨在传播和学术交流，其内容由作者负责，不代表本号观点。文中作品文字、图片等如涉及内容、版权和其他问题，请及时与我们联系，我们将在第一时间回复并处理。
